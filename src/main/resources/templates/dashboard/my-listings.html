<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>My Listings</title>
  <link th:href="@{/css/base.css}" rel="stylesheet"/>
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>
<div class="container">
  <h2>My Listings</h2>
  <div th:if="${successMessage}" class="flash" th:text="${successMessage}">Success</div>
  <p th:if="${page == null or page.empty}">You have not posted any properties yet.</p>
  <div class="grid" th:if="${page != null and !page.empty}">
    <div class="card" th:each="p : ${page.content}">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <strong th:text="${p.title}">Title</strong>
        <span class="badge" th:text="${p.approved? 'Approved':'Pending'}"
              th:classappend="${p.approved}? ' approved':' pending'">status</span>
      </div>
      <div th:text="${p.location}">Location</div>
      <div th:text="${#numbers.formatCurrency(p.price)}">$0</div>
      <small th:text="${#temporals.format(p.dateListed, 'MMM d, yyyy')}">Date</small>
      <div class="card-actions">
        <a class="link-button secondary" th:href="@{'/properties/' + ${p.id}}">View</a>
        <a class="link-button medium" th:href="@{'/properties/' + ${p.id} + '/edit'}">Edit</a>
        <form th:action="@{'/properties/' + ${p.id} + '/delete'}"
              method="post"
              onsubmit="return confirm('Delete this listing?');">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
          <button class="link-button danger" type="submit">Delete</button>
        </form>
      </div>
    </div>
  </div>
  <div th:replace="~{fragments/pagination :: pager(${page}, '/dashboard/me', ${searchParams})}"></div>
</div>
</body>
</html>
